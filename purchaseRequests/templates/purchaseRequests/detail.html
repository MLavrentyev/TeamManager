{% extends './base.html' %}
{% load staticfiles %}


{% block title %}Purchase Request for {{ pur_req.item }}{% endblock %}

{% block css %}
    <link rel="stylesheet" type="text/css" href="{% static 'purchaseRequests/css/detail.css' %}">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css"
          integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/"
          crossorigin="anonymous">
    <script type="text/javascript" src="{% static 'purchaseRequests/js/detail.js' %}"></script>
{% endblock %}

{% block content %}
    <div id="detail-div">

        {% if pur_req.author == user or user.is_superuser %}
        <a id="edit-button" href="{% url 'purchaseRequests:edit' pur_req.id %}">Edit</a>
        {% endif %}

        <h1 id="item-title">{{ pur_req.item }}</h1>
        <ul>
            <li>Cost: ${{ pur_req.cost }} x {{ pur_req.quantity }} = ${{ pur_req.line_total }}</li>
            <li>Time Added: {{ pur_req.timestamp }}</li>
            <li>Requester: {{ pur_req.author.username }}</li>
            <li id="link"><a href="{{ pur_req.link }}">{{ pur_req.link }}</a></li>
        </ul>
        {% if pur_req.notes %}
        <div id="notes-div">
            <div class="accordion">
                <hr>
                <button id="acc-button">Notes <i id="arrow" class="fas fa-angle-down"></i></button>
            </div>
            <span id="note-span" style="display: none;">{{ pur_req.notes }}</span>
        </div>
        {% endif %}
        <form id="approval-states-container" method="post" action="{% url 'purchaseRequests:detail' pur_req.id %}">
            {% csrf_token %}
            <table id="approval-states-table">
                <tr>
                    <td id="td-approved" class="{{ state.2 }} {{ selectable }}">
                        <button class="approval-button" type="submit" name="app-but"
                                form="approval-states-container" {{ disable_buttons }}>
                            <i class="fas fa-check"></i>
                        </button>
                    </td>
                    <td id="td-undecided" class="{{ state.1 }} {{ selectable }}">
                        <button class="approval-button" type="submit" name="und-but"
                                form="approval-states-container" {{ disable_buttons }}>
                            <i class="fas fa-question"></i>
                        </button>
                    </td>
                    <td id="td-denied" class="{{ state.0 }} {{ selectable }}">
                        <button class="approval-button" type="submit" name="den-but"
                                form="approval-states-container" {{ disable_buttons }}>
                            <i class="fas fa-times"></i>
                        </button>
                    </td>
                </tr>
            </table>
        </form>
    </div>
    <div id="purchase-timeline">
        <svg xmlns="http://www.w3.org/2000/svg" width="100%" height="24px">
            <line class="timeline-line timeline" x1="0" y1="12" x2="25%" y2="12"></line>
            <line class="timeline-line timeline" x1="25%" y1="12" x2="50%" y2="12"></line>
            <line class="timeline-line timeline" x1="50%" y1="12" x2="75%" y2="12"></line>
            <line class="timeline-line timeline" x1="75%" y1="12" x2="100%" y2="12"></line>

            <circle class="timeline-circle timeline" cx="25%" cy="12" r="8" fill="white"></circle>
            <circle class="timeline-circle timeline" cx="50%" cy="12" r="8" fill="white"></circle>
            <circle class="timeline-circle timeline" cx="75%" cy="12" r="8" fill="white"></circle>
        </svg>
    </div>
{% endblock %}